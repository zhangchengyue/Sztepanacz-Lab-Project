getwd()
setwd('/Users/ceferino/Documents/Drosophila_suzukii/Spot_evolution/data/')
spot.data <- read.table('results_plasticity.txt',
header=T, sep=',')
spot.data$TEMP <- factor(spot.data$TEMP)
library(ggplot2)
library(ggsignif)
library(car)
library(wesanderson)
library(cvequality)
Paris_idx <- which(spot.data$POP=='PARIS')
Sappo_idx <- which(spot.data$POP=='SAPPORO')
Sokol_idx <- which(spot.data$POP=='SOKOL')
temp16_idx <- which(spot.data$TEMP==16)
temp22_idx <- which(spot.data$TEMP==22)
temp28_idx <- which(spot.data$TEMP==28)
summary(aov(Wing ~ TEMP*POP, data = spot.data))
summary(aov(Ratio ~ TEMP*POP, data=spot.data))
spot.ind <- aov(Spot ~ Wing, data=spot.data)
spot.data$Res <- spot.ind$residuals
summary(aov(Res ~ TEMP*POP, data=spot.data))
summary(aov(Ratio ~ TEMP*POP, data=spot.data[-temp22_idx,]))
summary(aov(Res ~ TEMP*POP, data=spot.data[-temp22_idx,]))
summary(aov(Spot ~ Wing:TEMP, data = spot.data))
summary(aov(Spot ~ Wing:POP, data = spot.data))
ggplot(data = spot.data,
aes(x = Wing, y = Spot, color = POP)) +
geom_point() +
geom_smooth(method ='lm', se = FALSE) +
scale_color_manual(values = wes_palette(n=3, name = "GrandBudapest1"))
ggplot(data = spot.data,
aes(x = Wing, y = Spot, color = factor(TEMP))) +
geom_point() +
geom_smooth(method ='lm', se = FALSE) +
scale_color_manual(values = wes_palette(n=3, name = "GrandBudapest1"))
ggplot(data = spot.data,
aes(x = Wing, y = Spot, color = TEMP)) +
geom_point() +
geom_smooth(method ='lm', se = FALSE) +
scale_color_manual(values = wes_palette(n=3, name = "GrandBudapest1"))
summary(aov(Spot ~ Wing:TEMP, data = spot.data))
summary(aov(Spot ~ Wing:POP, data = spot.data))
summary(aov(Spot ~ POP, data = spot.data))
summary(aov(Res ~ Wing:TEMP, data=spot.data))
summary(aov(Res ~ Wing:POP, data=spot.data))
summary(aov(Ratio ~ Wing:TEMP, data=spot.data))
summary(aov(Ratio ~ Wing:POP, data=spot.data))
summary(aov(Ratio ~ POP, data=spot.data))
ggplot(data = spot.data,
aes(x = Wing, y = Ratio, color = TEMP)) +
geom_point() +
geom_smooth(method ='lm', se = FALSE) +
scale_color_manual(values = wes_palette(n=3, name = "GrandBudapest1"))
sd(spot.data$Wing[temp28_idx])/
mean(spot.data$Wing[temp28_idx])
sd(spot.data$Wing[temp22_idx])/
mean(spot.data$Wing[temp22_idx])
sd(spot.data$Wing[temp16_idx])/
mean(spot.data$Wing[temp16_idx])
sd(spot.data$Spot[temp28_idx])/
mean(spot.data$Spot[temp28_idx])
sd(spot.data$Spot[temp22_idx])/
mean(spot.data$Spot[temp22_idx])
sd(spot.data$Spot[temp16_idx])/
mean(spot.data$Spot[temp16_idx])
sd(spot.data$Spot)/
mean(spot.data$Spot)
sd(spot.data$Wing)/
mean(spot.data$Wing)
mslr_test(nr = 1000, x = spot.data$Wing[-temp16_idx],
y = as.character(spot.data$TEMP[-temp16_idx]))
mslr_test(nr = 1000, x = spot.data$Wing[-temp22_idx],
y = as.character(spot.data$TEMP[-temp22_idx]))
mslr_test(nr = 1000, x = spot.data$Wing[-temp28_idx],
y = as.character(spot.data$TEMP[-temp28_idx]))
mslr_test(nr = 1000, x = spot.data$Spot[-temp28_idx],
y = as.character(spot.data$TEMP[-temp28_idx]))
mslr_test(nr = 1000, x = spot.data$Spot,
y = as.character(spot.data$TEMP))
mslr_test(nr = 1000, x = spot.data$Wing,
y = as.character(spot.data$TEMP))
sd(spot.data$Spot)/
mean(spot.data$Spot)
sd(spot.data$Wing)/
mean(spot.data$Wing)
mslr_test(nr = 1000, x = spot.data$Ratio[-temp28_idx],
y = as.character(spot.data$TEMP[-temp28_idx]))
sd(spot.data$Spot[temp28_idx])/
mean(spot.data$Spot[temp28_idx])
sd(spot.data$Spot[temp28_idx])/
mean(spot.data$Spot[temp28_idx])
sd(spot.data$Spot[temp22_idx])/
mean(spot.data$Spot[temp22_idx])
sd(spot.data$Spot[temp16_idx])/
mean(spot.data$Spot[temp16_idx])
sd(spot.data$Wing[temp28_idx])/
mean(spot.data$Wing[temp28_idx])
sd(spot.data$Wing[temp22_idx])/
mean(spot.data$Wing[temp22_idx])
sd(spot.data$Wing[temp16_idx])/
mean(spot.data$Wing[temp16_idx])
mslr_test(nr = 1000, x = spot.data$Res[-temp16_idx],
y = as.character(spot.data$TEMP[-temp16_idx]))
mslr_test(nr = 1000, x = spot.data$Res[-temp22_idx],
y = as.character(spot.data$TEMP[-temp22_idx]))
mslr_test(nr = 1000, x = spot.data$Res[-temp28_idx],
y = as.character(spot.data$TEMP[-temp28_idx]))
sd(spot.data$Res[temp28_idx])/
mean(abs(spot.data$Res[temp28_idx]))
sd(spot.data$Res[temp22_idx])/
mean(abs(spot.data$Res[temp22_idx]))
sd(spot.data$Res[temp16_idx])/
mean(abs(spot.data$Res[temp16_idx]))
sd(spot.data$Res[temp28_idx])/
mean(spot.data$Res[temp28_idx])
sd(spot.data$Res[temp22_idx])/
mean(spot.data$Res[temp22_idx])
sd(spot.data$Res[temp16_idx])/
mean(spot.data$Res[temp16_idx])
mslr_test(nr = 1000, x = spot.data$Wing[-temp22_idx],
y = as.character(spot.data$TEMP[-temp22_idx]))
mslr_test(nr = 1000, x = spot.data$Wing[-temp16_idx],
y = as.character(spot.data$TEMP[-temp16_idx]))
mslr_test(nr = 1000, x = spot.data$Spot[-temp16_idx],
y = as.character(spot.data$TEMP[-temp16_idx]))
sd(spot.data$Wing[temp22_idx])/
mean(spot.data$Wing[temp22_idx])
sd(spot.data$Wing[temp28_idx])/
mean(spot.data$Wing[temp28_idx])
sd(spot.data$Spot[temp28_idx])/
mean(spot.data$Spot[temp28_idx])
sd(spot.data$Spot[temp22_idx])/
mean(spot.data$Spot[temp22_idx])
mslr_test(nr = 1000, x = spot.data$Spot[-temp22_idx],
y = as.character(spot.data$TEMP[-temp22_idx]))
sd(spot.data$Spot[temp16_idx])/
mean(spot.data$Spot[temp16_idx])
sd(spot.data$Ratio[temp28_idx])/
mean(spot.data$Ratio[temp28_idx])
sd(spot.data$Ratio[temp22_idx])/
mean(spot.data$Ratio[temp22_idx])
sd(spot.data$Ratio[temp16_idx])/
mean(spot.data$Ratio[temp16_idx])
mslr_test(nr = 1000, x = spot.data$Ratio[-temp22_idx],
y = as.character(spot.data$TEMP[-temp22_idx]))
mslr_test(nr = 1000, x = spot.data$Ratio[-temp16_idx],
y = as.character(spot.data$TEMP[-temp16_idx]))
leveneTest(spot.data$Wing[c(intersect(temp28_idx,Paris_idx),
intersect(temp28_idx,Sappo_idx))],
group = spot.data$POP[c(intersect(temp28_idx,Paris_idx),
intersect(temp28_idx,Sappo_idx))])
leveneTest(spot.data$Ratio[c(intersect(temp16_idx,Paris_idx),
intersect(temp16_idx,Sappo_idx))],
group = spot.data$POP[c(intersect(temp16_idx,Paris_idx),
intersect(temp16_idx,Sappo_idx))])
leveneTest(spot.data$Spot[temp16_idx], group = spot.data$POP[temp16_idx])
leveneTest(spot.data$Spot[c(intersect(temp16_idx,Paris_idx),
intersect(temp16_idx,Sappo_idx))],
group = spot.data$POP[c(intersect(temp16_idx,Paris_idx),
intersect(temp16_idx,Sappo_idx))])
leveneTest(spot.data$Spot[c(intersect(temp16_idx,Sokol_idx),
intersect(temp16_idx,Sappo_idx))],
group = spot.data$POP[c(intersect(temp16_idx,Sokol_idx),
intersect(temp16_idx,Sappo_idx))])
leveneTest(spot.data$Spot[c(intersect(temp16_idx,Paris_idx),
intersect(temp16_idx,Sokol_idx))],
group = spot.data$POP[c(intersect(temp16_idx,Paris_idx),
intersect(temp16_idx,Sokol_idx))])
sd(spot.data$Spot[intersect(temp16_idx,Sokol_idx)])
sd(spot.data$Spot[intersect(temp16_idx,Sappo_idx)])
leveneTest(spot.data$Ratio[c(intersect(temp16_idx,Sokol_idx),
intersect(temp16_idx,Sappo_idx))],
group = spot.data$POP[c(intersect(temp16_idx,Sokol_idx),
intersect(temp16_idx,Sappo_idx))])
leveneTest(spot.data$Ratio[c(intersect(temp16_idx,Paris_idx),
intersect(temp16_idx,Sappo_idx))],
group = spot.data$POP[c(intersect(temp16_idx,Paris_idx),
intersect(temp16_idx,Sappo_idx))])
sd(spot.data$Ratio[intersect(temp16_idx,Sappo_idx)])
sd(spot.data$Ratio[intersect(temp16_idx,Sokol_idx)])
leveneTest(spot.data$Wing[c(intersect(temp28_idx,Paris_idx),
intersect(temp28_idx,Sappo_idx))],
group = spot.data$POP[c(intersect(temp28_idx,Paris_idx),
intersect(temp28_idx,Sappo_idx))])
leveneTest(spot.data$Wing[c(intersect(temp28_idx,Sokol_idx),
intersect(temp28_idx,Sappo_idx))],
group = spot.data$POP[c(intersect(temp28_idx,Sokol_idx),
intersect(temp28_idx,Sappo_idx))])
mslr_test(nr = 1000, x = spot.data$Wing[Sappo_idx],
y = as.character(spot.data$TEMP[Sappo_idx]))
mslr_test(nr = 1000, x = spot.data$Spot[c(intersect(temp22_idx,Sappo_idx),
intersect(temp16_idx,Sappo_idx))],
y = as.character(spot.data$TEMP[c(intersect(temp22_idx,Sappo_idx),
intersect(temp16_idx,Sappo_idx))]))
sd(spot.data$Spot[intersect(temp16_idx,Sappo_idx)])/
mean(spot.data$Spot[intersect(temp16_idx,Sappo_idx)])
sd(spot.data$Spot[intersect(temp22_idx,Sappo_idx)])/
mean(spot.data$Spot[intersect(temp22_idx,Sappo_idx)])
sd(spot.data$Spot[intersect(temp28_idx,Sappo_idx)])/
mean(spot.data$Spot[intersect(temp28_idx,Sappo_idx)])
mslr_test(nr = 1000, x = spot.data$Spot[c(intersect(temp28_idx,Sappo_idx),
intersect(temp22_idx,Sappo_idx))],
y = as.character(spot.data$TEMP[c(intersect(temp28_idx,Sappo_idx),
intersect(temp22_idx,Sappo_idx))]))
sd(spot.data$Spot[intersect(temp28_idx,Paris_idx)])/
mean(spot.data$Spot[intersect(temp28_idx,Paris_idx)])
sd(spot.data$Spot[intersect(temp22_idx,Paris_idx)])/
mean(spot.data$Spot[intersect(temp22_idx,Paris_idx)])
sd(spot.data$Spot[intersect(temp16_idx,Paris_idx)])/
mean(spot.data$Spot[intersect(temp16_idx,Paris_idx)])
mslr_test(nr = 1000, x = spot.data$Spot[c(intersect(temp22_idx,Paris_idx),
intersect(temp16_idx,Paris_idx))],
y = as.character(spot.data$TEMP[c(intersect(temp22_idx,Paris_idx),
intersect(temp16_idx,Paris_idx))]))
mslr_test(nr = 1000, x = spot.data$Spot[c(intersect(temp22_idx,Sokol_idx),
intersect(temp16_idx,Sokol_idx))],
y = as.character(spot.data$TEMP[c(intersect(temp22_idx,Sokol_idx),
intersect(temp16_idx,Sokol_idx))]))
sd(spot.data$Spot[intersect(temp16_idx,Sokol_idx)])/
mean(spot.data$Spot[intersect(temp16_idx,Sokol_idx)])
sd(spot.data$Spot[intersect(temp22_idx,Sokol_idx)])/
mean(spot.data$Spot[intersect(temp22_idx,Sokol_idx)])
sd(spot.data$Spot[intersect(temp28_idx,Sokol_idx)])/
mean(spot.data$Spot[intersect(temp28_idx,Sokol_idx)])
mslr_test(nr = 1000, x = spot.data$Wing[Sappo_idx],
y = as.character(spot.data$TEMP[Sappo_idx]))
sd(spot.data$Wing[intersect(temp16_idx,Sappo_idx)])/
mean(spot.data$Wing[intersect(temp16_idx,Sappo_idx)])
sd(spot.data$Wing[intersect(temp22_idx,Sappo_idx)])/
mean(spot.data$Wing[intersect(temp22_idx,Sappo_idx)])
sd(spot.data$Wing[intersect(temp28_idx,Sappo_idx)])/
mean(spot.data$Wing[intersect(temp28_idx,Sappo_idx)])
sd(spot.data$Wing[intersect(temp16_idx,Sokol_idx)])/
mean(spot.data$Wing[intersect(temp16_idx,Sokol_idx)])
sd(spot.data$Wing[intersect(temp22_idx,Sokol_idx)])/
mean(spot.data$Wing[intersect(temp22_idx,Sokol_idx)])
sd(spot.data$Wing[intersect(temp28_idx,Sokol_idx)])/
mean(spot.data$Wing[intersect(temp28_idx,Sokol_idx)])
mslr_test(nr = 1000, x = spot.data$Wing[Sokol_idx],
y = as.character(spot.data$TEMP[Sokol_idx]))
mslr_test(nr = 1000, x = spot.data$Wing[Paris_idx],
y = as.character(spot.data$TEMP[Paris_idx]))
sd(spot.data$Wing[intersect(temp16_idx,Paris_idx)])/
mean(spot.data$Wing[intersect(temp16_idx,Paris_idx)])
sd(spot.data$Wing[intersect(temp22_idx,Paris_idx)])/
mean(spot.data$Wing[intersect(temp22_idx,Paris_idx)])
sd(spot.data$Wing[intersect(temp28_idx,Paris_idx)])/
mean(spot.data$Wing[intersect(temp28_idx,Paris_idx)])
sd(spot.data$Ratio[intersect(temp16_idx,Sokol_idx)])/
mean(spot.data$Ratio[intersect(temp16_idx,Sokol_idx)])
sd(spot.data$Ratio[intersect(temp22_idx,Sokol_idx)])/
mean(spot.data$Ratio[intersect(temp22_idx,Sokol_idx)])
sd(spot.data$Ratio[intersect(temp28_idx,Sokol_idx)])/
mean(spot.data$Ratio[intersect(temp28_idx,Sokol_idx)])
mslr_test(nr = 1000, x = spot.data$Ratio[Sokol_idx],
y = as.character(spot.data$TEMP[Sokol_idx]))
sd(spot.data$Ratio[intersect(temp28_idx,Paris_idx)])/
mean(spot.data$Ratio[intersect(temp28_idx,Paris_idx)])
sd(spot.data$Ratio[intersect(temp22_idx,Paris_idx)])/
mean(spot.data$Ratio[intersect(temp22_idx,Paris_idx)])
sd(spot.data$Ratio[intersect(temp16_idx,Paris_idx)])/
mean(spot.data$Ratio[intersect(temp16_idx,Paris_idx)])
ggplot(data = spot.data[Paris_idx,],
aes(x = factor(TEMP), y = Ratio, fill = POP)) +
geom_boxplot() +
scale_fill_manual(values = c('#F8766D'))
mslr_test(nr = 1000, x = spot.data$Ratio[Paris_idx],
y = as.character(spot.data$TEMP[Paris_idx]))
spot.nat <- read.table('results_natpops.txt',
header=T, sep=',')
spot.nat$POP <- factor(spot.nat$POP)
spot.mod <- aov(Spot ~ Wing, data=spot.nat)
spot.nat$Resid <- spot.mod$residuals
summary(aov(Spot ~ Wing*POP, data = spot.nat))
summary(aov(Ratio ~ Wing*POP, data = spot.nat))
temp <- read.table('temperatures.txt',
header=T, sep='\t')
temp <- read.table('temperatures.txt', header=T, sep='\t')
length(table(spot.nat$POP))
temp <- read.table('temperatures2.txt', header=T, sep='\t')
temp
prueba <- matrix(c(0,0),ncol=2)
for (i in 1:length(table(spot.nat$POP))) {
pru <- matrix(c(rep(as.character(temp[temp[,1]==names(table(spot.nat$POP))[i],1]),table(spot.nat$POP)[i]),
rep(temp[temp[,1]==names(table(spot.nat$POP))[i],4],table(spot.nat$POP)[i])),ncol=2)
prueba <- rbind(prueba,pru)
}
prueba
temp[,1]
names(table(spot.nat$POP))[1],1]
names(table(spot.nat$POP))[1]
table(spot.nat$POP)[1]
prueba
length(table(spot.nat$POP))
i
i <- 1
matrix(c(rep(as.character(temp[temp[,1]==names(table(spot.nat$POP))[i],1]),table(spot.nat$POP)[i]),
rep(temp[temp[,1]==names(table(spot.nat$POP))[i],4],table(spot.nat$POP)[i])),ncol=2)
as.character(temp[temp[,1]==names(table(spot.nat$POP))[i],1])
table(spot.nat$POP)
temp <- read.table('temperatures2.txt', header=T, sep='\t')
prueba <- matrix(c(0,0),ncol=2)
for (i in 1:length(table(spot.nat$POP))) {
pru <- matrix(c(rep(as.character(temp[temp[,1]==names(table(spot.nat$POP))[i],1]),table(spot.nat$POP)[i]),
rep(temp[temp[,1]==names(table(spot.nat$POP))[i],4],table(spot.nat$POP)[i])),ncol=2)
prueba <- rbind(prueba,pru)
}
prueba
i <- 1
as.character(temp[temp[,1]==names(table(spot.nat$POP))[i],1])
table(spot.nat$POP)[i]
matrix(c(rep(as.character(temp[temp[,1]==names(table(spot.nat$POP))[i],1]),table(spot.nat$POP)[i]),
rep(temp[temp[,1]==names(table(spot.nat$POP))[i],4],table(spot.nat$POP)[i])),ncol=2)
temp[temp[,1]==names(table(spot.nat$POP))[i],4]
temp[temp[,1]
temp[temp[,1]==names(table(spot.nat$POP))[i],4]
table(spot.nat$POP)[i]
prueba <- matrix(c(0,0),ncol=2)
for (i in 1:length(table(spot.nat$POP))) {
pru <- matrix(c(rep(as.character(temp[temp[,1]==names(table(spot.nat$POP))[i],1]),table(spot.nat$POP)[i]),
rep(temp[temp[,1]==names(table(spot.nat$POP))[i],2],table(spot.nat$POP)[i])),ncol=2)
prueba <- rbind(prueba,pru)
}
prueba
temps <- as.numeric(prueba[-1,2])
temps
summary(aov(Spot ~ temps, data = spot.nat))
spot.nat$TEMP <- temps
ggplot(data=spot.nat,
aes(x = TEMP, y = Spot, color = POP)) +
geom_point() +
geom_smooth(method = 'lm', se = FALSE)
plot(spot.nat$Spot, temps)
plot(temps,spot.nat$Spot)
temp
summary(aov(Wing ~ temps, data = spot.nat))
summary(aov(Ratio ~ temps, data = spot.nat))
plot(temps,spot.nat$Ratio)
summary(aov(Ratio ~ TEMP, data = spot.nat))
plot(temps,spot.nat$Wing)
ggplot(data=spot.nat,
aes(x = TEMP, y = Spot, color = POP)) +
geom_point() +
geom_smooth(method = 'lm', se = FALSE)
ggplot(data=spot.nat,
aes(x = TEMP, y = Spot, color = POP)) +
geom_point() +
geom_smooth(method = 'lm', se = TRUE)
summary(aov(Res ~ TEMP, data = spot.nat))
summary(aov(Resid ~ TEMP, data = spot.nat))
spot.nat
ggplot(data=spot.nat,
aes(x = TEMP, y = Ratio, color = POP)) +
geom_point() +
geom_smooth(method = 'lm', se = TRUE)
ggplot(data=spot.nat,
aes(x = TEMP, y = Resid, color = POP)) +
geom_point() +
geom_smooth(method = 'lm', se = TRUE)
